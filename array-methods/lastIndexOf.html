<script src="../tinytest.js"></script>
<script>
  'use strict'
// Main Objective
  // The lastIndexOf() method returns the last index at which a given element can be found in the array, or -1 if it is not present. The array is searched backwards, starting at fromIndex.
  
// Prototype function 
  // function lastIndexOf(array, searchElement, fromIndex) {
  //   for (let i = array.length - 1; i >= 0; i--) {
  //     if (searchElement === array[i]) {
  //       return i;
  //     }
  //   }
  //   return -1;
  // }



// Function signature 
  // lastIndexOf(array, searchElement, fromIndex);

// Function Parameters 
  // searchElement -> Element to locate in array
  // optional fromIndex -> The index to start searching backwards

// Return value 
  // The last index of the element in the array; -1 if not found.


// Requirements 
    

  // 1. It should compares searchElement to the elements of the array in descending order(array.length -1) using the Strict Equality Comparison returning the element index that pass the test.
  // 2. If fromIndex is provided the array search should start fromIndex in descending order.
  // 3. If fromIndex is greater than or equal to the length of the array, the whole array will be searched.
  // 4. If fromIndex is negative, it is taken as the offset from the end of the array from right to left. 
  // 5. If searchElement is not found in the array, it will return -1.
  // 6. If the the provided fromIndex is negative and the calculated index is less than 0 (arraylength - fromIndex), -1 is returned, i.e. the array will not be searched.


    function lastIndexOf(array, searchElement, indexFrom) {
      let startingIndex = array.length -1;

      if (indexFrom) { // If indexFrom is provided
        if (indexFrom >= array.length) { // If indexFrom is greater or equal to array.length;
          startingIndex = array.length -1;
        }
        if (indexFrom < 0) { // if indexFrom is negative
         
          if (array.length - Math.abs(indexFrom) < 0) {
            return -1;
          }
          
          startingIndex = array.length - Math.abs(indexFrom);
        } else {
           startingIndex = indexFrom;
        }
     
      }

      for (let i = startingIndex; i >= 0; i--) {
        if (searchElement === array[i]) {
          return i;
        }
      }
      return -1;
    }


  tests({ 


    '1. It should compares searchElement to the elements of the array in descending order(array.length -1) using the Strict Equality Comparison returning the element index that pass the test.': function () {
      let lastIndexOfReturnedValue = lastIndexOf([1, 2, 3, 1], 1);
      eq(lastIndexOfReturnedValue, 3);
    },

    '2. If fromIndex is provided the array search should start fromIndex in descending order.': function () {
      let lastIndexOfReturnedValue = lastIndexOf([1, 2, 3, 1], 1, 2);
      eq(lastIndexOfReturnedValue, 0);
    },

    '3. If fromIndex is greater than or equal to the length of the array, the whole array will be searched.': function () {
      let lastIndexOfReturnedValue = lastIndexOf([1, 2, 3, 4, 5, 2], 2, 8);
      eq(lastIndexOfReturnedValue, 5);
    },

    '4. If fromIndex is negative, it is taken as the offset from the end of the array from right to left. ': function () {
      debugger;
      let lastIndexOfReturnedValue = lastIndexOf([4, 5, 1, 2, 3, 1], 1, -3 );
      eq(lastIndexOfReturnedValue, 2);
    },

    '5. If searchElement is not found in the array, it will return -1.': function () {
      let lastIndexOfReturnedValue = lastIndexOf([1, 2, 3, 4, 5, 6], 7);
      eq(lastIndexOfReturnedValue, -1);
    },

    '6. If the the provided fromIndex is negative and the calculated index is less than 0 (arraylength - fromIndex), -1 is returned, i.e. the array will not be searched.': 
    function () {
      let lastIndexOfReturnedValue = lastIndexOf([1, 2, 3, 4, 5, 6, 7], 1, -8);
      eq(lastIndexOfReturnedValue, -1);
    },

  });
</script>